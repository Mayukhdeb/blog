<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta property="og:title" content=" Finally the bridge works now &middot;  @mayukhdeb" />
  <meta property="og:site_name" content="@mayukhdeb" />
  <meta property="og:url" content="https://mayukhdeb.github.io/blog/post/gsoc-2020-july-19/" />
  <meta name="theme" content="darksimplicity">
  <meta name="generator" content="Hugo 0.74.3" />
  
  
  <base href="https://mayukhdeb.github.io/blog/">
  <title> Finally the bridge works now &middot;  @mayukhdeb</title>
  <link rel="stylesheet" href="https://mayukhdeb.github.io/blog/css/style.min.css">

</head>
<body>
  <header>
      <nav role="top-nav">
          <ul class="navbar-list">
            
            <li class="navbar-item"><a class="navbar-link" href="https://github.com/Mayukhdeb">Github</a></li>
            <li class="navbar-item"><a class="navbar-link" href="https://twitter.com/mayukh091">Twitter</a></li>
          </ul>
      </nav>
      <br />
      <h1><a href="https://mayukhdeb.github.io/blog/" class="title">@mayukhdeb</a>
        
      </h1>
  </header>
  <main>
      <article itemscope itemtype="http://schema.org/Blog">
        <h3><a class="post-title-link" href="https://mayukhdeb.github.io/blog/post/gsoc-2020-july-19/">Finally the bridge works now</a></h3>
        
            <div class="tags">tags: &nbsp;
              <span itemprop="keywords"><a class="tag-link" href="https://mayukhdeb.github.io/blog/tags/gsoc" rel="tag">GSoC </a><a class="tag-link" href="https://mayukhdeb.github.io/blog/tags/openworm" rel="tag">OpenWorm </a><a class="tag-link" href="https://mayukhdeb.github.io/blog/tags/deep-learning" rel="tag">deep learning </a>
              </span>
          </div>
          <div class="content-full"><h2 id="the-bridge-works-now">The bridge works now</h2>
<figure>
    <img src="https://raw.githubusercontent.com/devoworm/GSoC-2020/master/Pre-trained%20Models%20%28DevLearning%29/images/resnet_preds_with_input.gif" width="50%"/> 
</figure>

<p>So, after cleaning up the data last week, I started training the model again from scratch. This time I included all the bells and whistles like <code>ReduceLROnPlateau</code> and image augmentation with <code>albumentations</code>. Check out  <a href="https://nbviewer.jupyter.org/github/devoworm/GSoC-2020/blob/master/Pre-trained%20Models%20%28DevLearning%29/notebooks/embryo_analysis/video_analysis/estimate_cell_family_population.ipynb">this notebook</a> for the code.</p>
<p>All the values of the populations were yet again normalised to values between -1 and 1. The <code>ResNet18</code> was customized to a smaller last layer (7 in our case, because 7 lineages of cells).</p>
<figure>
    <img src="https://raw.githubusercontent.com/devoworm/GSoC-2020/master/Pre-trained%20Models%20%28DevLearning%29/images/resnet18_pipeline.jpg" width="50%"/> 
</figure>

<p>And after training the model for 8 epochs, the model was able to estimate the populations pretty well. So much so that it was almost at par with the accuracy of the real data.</p>
<p>We fed a whole timelapse of the embryogenesis of the C. elegans embryo into the trained model and plotted its predictions, and compared it with the real values as shown:</p>
<p><figure>
    <img src="https://mayukhdeb.github.io/blog/post/images/july_19/pred.png" width="50%"/> 
</figure>

<figure>
    <img src="https://mayukhdeb.github.io/blog/post/images/july_19/pred_2.png" width="50%"/> 
</figure>
</p>
<hr>
<h2 id="py_eleganshttpsgithubcomdevowormgsoc-2020treemasterpre-trained20models20devlearningpy_elegans"><a href="https://github.com/devoworm/GSoC-2020/tree/master/Pre-trained%20Models%20(DevLearning)/py_elegans">Py_elegans</a></h2>
<p>Apart from all of this, I also started working  on a python library, which would make these deep learning models I&rsquo;ve been training more accessible to the commmunity through a high level framework. For now it&rsquo;s temporarily named &ldquo;py_elegans&rdquo;.</p>
<p>In this framework, loading up a pretrained model would be as easy as</p>
<p><code>from pyelegans import lineage_population_model</code></p>
<p>and predictions can be made using:</p>
<p><code>pred = model.predict(image_path = &quot;sample.png&quot;)</code></p>
<p>More updates on this next week.</p>

</div>
      </article>
  </main>
  <footer>
      <div class="copyright"><p>

&copy; 2020. 

@mayukhdeb. All rights reserved. 

</div>    



  </footer>

<body>
</body>

</html>

