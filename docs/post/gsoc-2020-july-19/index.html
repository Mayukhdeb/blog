<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Finally the bridge works now | @mayukhdeb</title>

<meta name="keywords" content="GSoC, OpenWorm, deep learning" />
<meta name="description" content="Google summer of code week 9">
<meta name="author" content="">
<link rel="canonical" href="https://mayukhdeb.github.io/blog/post/gsoc-2020-july-19/" />
<link href="https://mayukhdeb.github.io/blog/assets/css/stylesheet.min.d1bc2b736056bd5698d770eeedc08a73bce9e6cebb30810f6f1b2c2048e46ab8.css" integrity="sha256-0bwrc2BWvVaY13Du7cCKc7zp5s67MIEPbxssIEjkarg=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://mayukhdeb.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://mayukhdeb.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://mayukhdeb.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://mayukhdeb.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://mayukhdeb.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.68.3" />


<meta property="og:title" content="Finally the bridge works now" />
<meta property="og:description" content="Google summer of code week 9" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mayukhdeb.github.io/blog/post/gsoc-2020-july-19/" />
<meta property="article:published_time" content="2020-07-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-07-19T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Finally the bridge works now"/>
<meta name="twitter:description" content="Google summer of code week 9"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Finally the bridge works now",
  "name": "Finally the bridge works now",
  "description": "Google Summer of Code | Coding period week 7",
  "keywords": [
    "GSoC", "OpenWorm", "deep learning"
  ],
  "articleBody": "The bridge works now   So, after cleaning up the data last week, I started training the model again from scratch. This time I included all the bells and whistles like ReduceLROnPlateau and image augmentation with albumentations. Check out this notebook for the code.\nAll the values of the populations were yet again normalised to values between -1 and 1. The ResNet18 was customized to a smaller last layer (7 in our case, because 7 lineages of cells).\n  And after training the model for 8 epochs, the model was able to estimate the populations pretty well. So much so that it was almost at par with the accuracy of the real data.\nWe fed a whole timelapse of the embryogenesis of the C. elegans embryo into the trained model and plotted its predictions, and compared it with the real values as shown:\n     Py_elegans Apart from all of this, I also started working on a python library, which would make these deep learning models I’ve been training more accessible to the commmunity through a high level framework. For now it’s temporarily named “py_elegans”.\nIn this framework, loading up a pretrained model would be as easy as\nfrom pyelegans import lineage_population_model\nand predictions can be made using:\npred = model.predict(image_path = \"sample.png\")\nMore updates on this next week.\n",
  "wordCount" : "215",
  "inLanguage": "en",
  "datePublished": "2020-07-19T00:00:00Z",
  "dateModified": "2020-07-19T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://mayukhdeb.github.io/blog/post/gsoc-2020-july-19/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "@mayukhdeb",
    "logo": {
      "@type": "ImageObject",
      "url": "https://mayukhdeb.github.io/blog/favicon.ico"
    }
  }
}
</script>



</head>

<body class="">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://mayukhdeb.github.io/blog/" accesskey="h" title="@mayukhdeb (Alt + H)">@mayukhdeb</a>
            <span class="logo-switches">
                <span class="theme-toggle" title="(Alt + T)">
                    <a id="theme-toggle" accesskey="t">
                        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </a>
                </span>
                
            </span>
        </div>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()"></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">
      Finally the bridge works now
    </h1>
    <div class="post-meta">July 19, 2020

    </div>
  </header> 

  <div class="post-content">
<h2 id="the-bridge-works-now">The bridge works now<a hidden class="anchor" aria-hidden="true" href="#the-bridge-works-now">#</a></h2>
<figure>
    <img src="https://raw.githubusercontent.com/devoworm/GSoC-2020/master/Pre-trained%20Models%20%28DevLearning%29/images/resnet_preds_with_input.gif" width="50%"/> 
</figure>

<p>So, after cleaning up the data last week, I started training the model again from scratch. This time I included all the bells and whistles like <code>ReduceLROnPlateau</code> and image augmentation with <code>albumentations</code>. Check out  <a href="https://nbviewer.jupyter.org/github/devoworm/GSoC-2020/blob/master/Pre-trained%20Models%20%28DevLearning%29/notebooks/embryo_analysis/video_analysis/estimate_cell_family_population.ipynb">this notebook</a> for the code.</p>
<p>All the values of the populations were yet again normalised to values between -1 and 1. The <code>ResNet18</code> was customized to a smaller last layer (7 in our case, because 7 lineages of cells).</p>
<figure>
    <img src="https://raw.githubusercontent.com/devoworm/GSoC-2020/master/Pre-trained%20Models%20%28DevLearning%29/images/resnet18_pipeline.jpg" width="50%"/> 
</figure>

<p>And after training the model for 8 epochs, the model was able to estimate the populations pretty well. So much so that it was almost at par with the accuracy of the real data.</p>
<p>We fed a whole timelapse of the embryogenesis of the C. elegans embryo into the trained model and plotted its predictions, and compared it with the real values as shown:</p>
<p><figure>
    <img src="https://raw.githubusercontent.com/Mayukhdeb/blog/master/content/post/images/july_19/pred.png" width="50%"/> 
</figure>

<figure>
    <img src="https://raw.githubusercontent.com/Mayukhdeb/blog/master/content/post/images/july_19/pred_2.png" width="50%"/> 
</figure>
</p>
<hr>
<h2 id="py_eleganshttpsgithubcomdevowormgsoc-2020treemasterpre-trained20models20devlearningpy_elegans"><a href="https://github.com/devoworm/GSoC-2020/tree/master/Pre-trained%20Models%20(DevLearning)/py_elegans">Py_elegans</a><a hidden class="anchor" aria-hidden="true" href="#py_eleganshttpsgithubcomdevowormgsoc-2020treemasterpre-trained20models20devlearningpy_elegans">#</a></h2>
<p>Apart from all of this, I also started working  on a python library, which would make these deep learning models I&rsquo;ve been training more accessible to the commmunity through a high level framework. For now it&rsquo;s temporarily named &ldquo;py_elegans&rdquo;.</p>
<p>In this framework, loading up a pretrained model would be as easy as</p>
<p><code>from pyelegans import lineage_population_model</code></p>
<p>and predictions can be made using:</p>
<p><code>pred = model.predict(image_path = &quot;sample.png&quot;)</code></p>
<p>More updates on this next week.</p>

</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://mayukhdeb.github.io/blog/tags/deep-learning/">Deep learning</a></li>
      <li><a href="https://mayukhdeb.github.io/blog/tags/gsoc/">GSoC</a></li>
      <li><a href="https://mayukhdeb.github.io/blog/tags/openworm/">OpenWorm</a></li>
    </ul>
  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2021 <a href="https://mayukhdeb.github.io/blog/">@mayukhdeb</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<button class="top-link" id="top-link" type="button" aria-label="go to top" title="Go to Top (Alt + G)" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6">
        <path d="M12 6H0l6-6z" /></svg>
</button>



<script defer src="https://mayukhdeb.github.io/blog/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
    mybutton.onclick = function () {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
        window.location.hash = ''
    }

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
