<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Deep chicken saviour | @mayukhdeb</title>

<meta name="keywords" content="adversarial attacks, Computer vision, Deep learning" />
<meta name="description" content="using adversarial attacks as a contermeasure against deep-chicken-terminator">
<meta name="author" content="">
<link rel="canonical" href="https://mayukhdeb.github.io/blog/post/deep-chicken-saviour/" />
<link href="https://mayukhdeb.github.io/blog/assets/css/stylesheet.min.d1bc2b736056bd5698d770eeedc08a73bce9e6cebb30810f6f1b2c2048e46ab8.css" integrity="sha256-0bwrc2BWvVaY13Du7cCKc7zp5s67MIEPbxssIEjkarg=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://mayukhdeb.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://mayukhdeb.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://mayukhdeb.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://mayukhdeb.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://mayukhdeb.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.68.3" />


<meta property="og:title" content="Deep chicken saviour" />
<meta property="og:description" content="using adversarial attacks as a contermeasure against deep-chicken-terminator" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mayukhdeb.github.io/blog/post/deep-chicken-saviour/" />
<meta property="article:published_time" content="2020-04-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deep chicken saviour"/>
<meta name="twitter:description" content="using adversarial attacks as a contermeasure against deep-chicken-terminator"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Deep chicken saviour",
  "name": "Deep chicken saviour",
  "description": "Adversarial attacks as a contermeasure against deep-chicken-terminator",
  "keywords": [
    "adversarial attacks", "Computer vision", "Deep learning"
  ],
  "articleBody": "Before:   After:   Adversarial blocks generated by negative epsilon FGSM to confuse the traned deep neural network These blocks are made by starting out with a dark grey image and then backpropagating on the image with the pre trained network with a negative epsilon in order to minimise loss for the target class, a more negative epsilon will not necessarily give a better result. But it’s a bell curve instead, and the epsilon is optimized by looking for the local target class probability maxima in the domain [lower_limit, 0)\nThese adversarial blocks can be generated for any animal class.\n  Fast Gradient Sign Method :chart_with_upwards_trend:  sign(data_gradients) gives the element wise signs of the data gradient epsilon defines the “strength” of the perturbation of the image  In a nutshell, instead of optimizing the model to reduce the loss, we’re un-optimizing the input image to maximise loss.\n  This works primarily because of the piecewise linear nature of deep neural networks. For example, look at ReLU or at maxout functions, they’re all piecewise linear. Even a carefully tuned sigmoid has an approximate linear nature when taken piecewise.\n  With varying values of epsilon, we will see an approximately linear relationship between “confidence” and epsilon.\n  Negative epsilon FGSM  this can be used to turn one animal into another specific animal for the deep neural network  How are the images “optimized” using the same FGSM ?  The key here is to understand how FGSM actually worked. In FGSM, we were tampering with the pixels which has a positive gradient and added a certain value gradient * epsilon to each of those pixels. This made the image deviate further and further away from the class it actually belongs to and thus maximising loss in the process. Note that this was done with a positive epsilon value  But for our current objective, we will try to “optimize” the image to a different class. This can be done by:\n Doing a forward pass with an image of class x and with a label of y. Where y is the class to which we want to convert our image to. Performing a backpropagation on the network and extracting the gradients on the input image. Now instead of trying to maximise loss using the FGSM, we’ll reduce the loss with a negative epsilon FGSM. This will help reduce the loss of the image with respect to the target class y, and with a sufficiently negative epsilon value, the image gets mis-classified as the target class.  If you didn’t read the boring stuff above, just remember that\n A positive epsilon value will un-optimize the image A negative epsilon value will optimize the image for the given label class  Generating adversarial patches from black images ",
  "wordCount" : "450",
  "inLanguage": "en",
  "datePublished": "2020-04-01T00:00:00Z",
  "dateModified": "2020-04-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://mayukhdeb.github.io/blog/post/deep-chicken-saviour/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "@mayukhdeb",
    "logo": {
      "@type": "ImageObject",
      "url": "https://mayukhdeb.github.io/blog/favicon.ico"
    }
  }
}
</script>



</head>

<body class="">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://mayukhdeb.github.io/blog/" accesskey="h" title="@mayukhdeb (Alt + H)">@mayukhdeb</a>
            <span class="logo-switches">
                <span class="theme-toggle" title="(Alt + T)">
                    <a id="theme-toggle" accesskey="t">
                        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </a>
                </span>
                
            </span>
        </div>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()"></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">
      Deep chicken saviour
    </h1>
    <div class="post-meta">April 1, 2020

    </div>
  </header> 

  <div class="post-content">
<h2 id="before">Before:<a hidden class="anchor" aria-hidden="true" href="#before">#</a></h2>
<figure>
    <img src="https://raw.githubusercontent.com/Mayukhdeb/deep-chicken-saviour/master/images/no_FGSM.gif" width="60%"/> 
</figure>

<h2 id="after">After:<a hidden class="anchor" aria-hidden="true" href="#after">#</a></h2>
<figure>
    <img src="https://raw.githubusercontent.com/Mayukhdeb/deep-chicken-saviour/master/images/FGSM.gif" width="60%"/> 
</figure>

<h2 id="adversarial-blocks-generated-by-negative-epsilon-fgsm-to-confuse-the-traned-deep-neural-network">Adversarial blocks generated by negative epsilon FGSM to confuse the traned deep neural network<a hidden class="anchor" aria-hidden="true" href="#adversarial-blocks-generated-by-negative-epsilon-fgsm-to-confuse-the-traned-deep-neural-network">#</a></h2>
<p>These blocks are made by starting out with a dark grey image and then backpropagating on the image with the pre trained network with a negative epsilon in order to minimise loss for the target class, a more negative epsilon will not necessarily give a better result. But it&rsquo;s a bell curve instead, and the epsilon is optimized by looking for the local target class probability maxima in the domain [<code>lower_limit</code>, <code>0</code>)</p>
<p>These adversarial blocks can be generated for any animal class.</p>
<p><img src="https://raw.githubusercontent.com/Mayukhdeb/deep-chicken-saviour/master/images/patch_to_block.png" alt="patch_to_block"></p>
<!-- raw HTML omitted -->
<figure>
    <img src="https://raw.githubusercontent.com/Mayukhdeb/deep-chicken-saviour/master/images/adv_block.gif" width="60%"/> 
</figure>

<h2 id="fast-gradient-sign-method-chart_with_upwards_trend">Fast Gradient Sign Method :chart_with_upwards_trend:<a hidden class="anchor" aria-hidden="true" href="#fast-gradient-sign-method-chart_with_upwards_trend">#</a></h2>
<!-- raw HTML omitted -->
<ul>
<li><code>sign(data_gradients)</code> gives the element wise signs of the data gradient</li>
<li><code>epsilon</code> defines the &ldquo;strength&rdquo; of the perturbation of the image</li>
</ul>
<p>In a nutshell, instead of <strong>optimizing the model to reduce the loss</strong>, we&rsquo;re <strong>un-optimizing the input image to maximise loss</strong>.</p>
<ul>
<li>
<p>This works primarily because of the piecewise linear nature of deep neural networks. For example, look at ReLU or at maxout functions, they&rsquo;re all piecewise linear. Even a carefully tuned sigmoid has an approximate linear nature when taken piecewise.</p>
</li>
<li>
<p>With varying values of epsilon, we will see an approximately linear relationship between &ldquo;confidence&rdquo; and epsilon.</p>
</li>
</ul>
<h2 id="negative-epsilon-fgsm">Negative epsilon FGSM<a hidden class="anchor" aria-hidden="true" href="#negative-epsilon-fgsm">#</a></h2>
<ul>
<li>this can be used to turn one animal into another specific animal for the deep neural network</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Mayukhdeb/deep-chicken-saviour/master/images/negative_eps_FGSM.png" alt="no_FGSM"></p>
<h2 id="how-are-the-images-optimized-using-the-same-fgsm-">How are the images &ldquo;optimized&rdquo; using the same FGSM ?<a hidden class="anchor" aria-hidden="true" href="#how-are-the-images-optimized-using-the-same-fgsm-">#</a></h2>
<ul>
<li>The key here is to understand how FGSM actually worked.
In FGSM, we were tampering with the pixels which has a <em>positive</em> gradient and added a certain value <code>gradient * epsilon</code> to each of those pixels. This made the image deviate further and further away from the class it actually belongs to and thus maximising loss in the process. Note that this was done with a <strong>positive epsilon</strong> value</li>
</ul>
<p>But for our current objective, we will try to &ldquo;optimize&rdquo; the image to a different class. This can be done by:</p>
<ul>
<li>Doing a forward pass with an image of class <code>x</code> and with a label of <code>y</code>. Where <code>y</code> is the class to which we want to convert our image to.</li>
<li>Performing a backpropagation on the network and extracting the gradients on the input image.</li>
<li>Now instead of trying to maximise loss using the FGSM, we&rsquo;ll reduce the loss with a <strong>negative epsilon</strong> FGSM.</li>
<li>This will help reduce the loss of the image with respect to the target class <code>y</code>, and with a sufficiently  negative epsilon value, the image gets mis-classified as the target class.</li>
</ul>
<p>If you didn&rsquo;t read the boring stuff above, just remember that</p>
<ul>
<li>A <strong>positive epsilon</strong> value will <strong>un-optimize</strong> the image</li>
<li>A <strong>negative epsilon</strong> value will <strong>optimize</strong> the image for the given label class</li>
</ul>
<h2 id="generating-adversarial-patches-from-black-images">Generating adversarial patches from black images<a hidden class="anchor" aria-hidden="true" href="#generating-adversarial-patches-from-black-images">#</a></h2>
<p><img src="https://raw.githubusercontent.com/Mayukhdeb/deep-chicken-saviour/master/images/adversarial_patches.png" alt="no_FGSM"></p>

</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://mayukhdeb.github.io/blog/tags/deep-learning/">Deep learning</a></li>
      <li><a href="https://mayukhdeb.github.io/blog/tags/computer-vision/">Computer vision</a></li>
      <li><a href="https://mayukhdeb.github.io/blog/tags/adversarial-attacks/">adversarial attacks</a></li>
    </ul>
  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2021 <a href="https://mayukhdeb.github.io/blog/">@mayukhdeb</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<button class="top-link" id="top-link" type="button" aria-label="go to top" title="Go to Top (Alt + G)" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6">
        <path d="M12 6H0l6-6z" /></svg>
</button>



<script defer src="https://mayukhdeb.github.io/blog/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
    mybutton.onclick = function () {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
        window.location.hash = ''
    }

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
